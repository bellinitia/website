{% include base_path %}

<meta charset="utf-8">

{% include seo.html %}

{% comment %}
Global HTML <title> override for better SEO,
while keeping page.title clean for Zotero and schema.
{% endcomment %}

{% assign page_type = nil %}

{%- comment -%}
Detect type and display label for publications
{%- endcomment -%}
{% if page.collection == 'publications' %}
  {% if page.extra == 'thesis' %}
    {% assign page_type = 'Thesis' %}
  {% elsif page.extra == 'chapter' %}
    {% assign page_type = 'Book Chapter' %}
  {% elsif page.category == 'books' %}
    {% assign page_type = 'Book' %}
  {% elsif page.category == 'journal' %}
    {% assign page_type = 'Journal Article' %}
  {% elsif page.category == 'conference' %}
    {% assign page_type = 'Conference Paper' %}
  {% elsif page.category == 'other' %}
    {% assign page_type = 'Preprint' %}
  {% endif %}
{% endif %}

{%- comment -%}
Build the SEO title string based on collection
{%- endcomment -%}
{% capture computed_title %}
  {% if page.collection == 'publications' %}
    {{ page.title }}{% if page_type %} - {{ page_type }}{% endif %} - Mattia Bellini

  {% elsif page.collection == 'talks' %}
    {{ page.title }}{% if page.venue %} - {{ page.venue }}{% endif %} - Mattia Bellini

  {% elsif page.collection == 'portfolio' %}
    {{ page.title }} - Mattia Bellini

  {% elsif page.collection == 'teaching' %}
    {{ page.title }}{% if page.university %} - {{ page.university }}{% endif %} - Mattia Bellini

  {% else %}
    {%- comment -%}
    Fallback for other pages: keep it simple, or include site title
    {%- endcomment -%}
    {% if page.title %}
      {{ page.title }} - Mattia Bellini
    {% else %}
      {{ site.title }}{% if site.title and site.tagline %} - {{ site.tagline }}{% endif %}
    {% endif %}
  {% endif %}
{% endcapture %}

<title>{{ computed_title | strip }}</title>


<link href="{% if site.atom_feed.path %}{{ site.atom_feed.path }}{% else %}{{ base_path }}/feed.xml{% endif %}" type="application/atom+xml" rel="alternate" title="{{ site.title }} Feed">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="{{ base_path }}/assets/css/main.css">


<!-- Zotero Metadata -->
{% if page.title %}
<meta name="citation_title" content="{{ page.title | escape }}">
<meta name="dc.title" content="{{ page.title | escape }}">
{% endif %}

{% if page.authors %}
  {% for a in page.authors %}
  <meta name="citation_author" content="{{ a | escape }}">
  <meta name="dc.creator" content="{{ a | escape }}">
  {% endfor %}
{% endif %}

{% if page.date %}
<meta name="citation_publication_date" content="{{ page.date | date: '%Y/%m/%d' }}">
<meta name="dc.date" content="{{ page.date | date_to_xmlschema }}">
{% endif %}

{% comment %}========== ITEM TYPE FOR REFERENCE MANAGERS ========={% endcomment %}
{% if page.extra == 'thesis' %}
  {% comment %}Special case: Thesis{% endcomment %}
  <meta name="citation_type" content="thesis">
  <meta name="dc.type" content="Thesis">
  {% if page.venue %}
    <meta name="citation_publisher" content="{{ page.venue | escape }}">
    <meta name="citation_dissertation_institution" content="{{ page.venue | escape }}">
  {% endif %}
  
{% elsif page.extra == 'chapter' %}
  {% comment %}Special case: Book Chapter{% endcomment %}
  <meta name="citation_type" content="chapter">
  <meta name="dc.type" content="Book Chapter">
  {% if page.book_title %}
    <meta name="citation_book_title" content="{{ page.book_title | escape }}">
  {% endif %}
  {% if page.editors %}
    {% for editor in page.editors %}
    <meta name="citation_editor" content="{{ editor | escape }}">
    {% endfor %}
  {% endif %}
  {% if page.venue %}
    <meta name="citation_publisher" content="{{ page.venue | escape }}">
  {% endif %}
  
{% elsif page.category == 'books' %}
  <meta name="citation_type" content="book">
  <meta name="dc.type" content="Book">
  {% if page.venue %}
    <meta name="citation_publisher" content="{{ page.venue | escape }}">
  {% endif %}
  
{% elsif page.category == 'journal' %}
  <meta name="citation_type" content="journal_article">
  <meta name="dc.type" content="Article">
  {% if page.venue %}
    <meta name="citation_journal_title" content="{{ page.venue | escape }}">
  {% endif %}
  
{% elsif page.category == 'conference' %}
  <meta name="citation_type" content="conference_paper">
  <meta name="dc.type" content="Conference Paper">
  {% if page.venue %}
    <meta name="citation_conference_title" content="{{ page.venue | escape }}">
  {% endif %}
  
{% elsif page.category == 'other' %}
  <meta name="citation_type" content="preprint">
  <meta name="dc.type" content="Preprint">
  {% if page.venue %}
    <meta name="citation_publisher" content="{{ page.venue | escape }}">
  {% endif %}
  
{% else %}
  {% comment %}Fallback for uncategorized items{% endcomment %}
  <meta name="citation_type" content="article">
  <meta name="dc.type" content="Article">
  {% if page.venue %}
    <meta name="citation_publisher" content="{{ page.venue | escape }}">
  {% endif %}
{% endif %}



{% if page.volume %}<meta name="citation_volume" content="{{ page.volume | escape }}">{% endif %}
{% if page.issue %}<meta name="citation_issue" content="{{ page.issue | escape }}">{% endif %}
{% if page.firstpage %}<meta name="citation_firstpage" content="{{ page.firstpage | escape }}">{% endif %}
{% if page.lastpage %}<meta name="citation_lastpage" content="{{ page.lastpage | escape }}">{% endif %}

{% if page.doi %}
<meta name="citation_doi" content="{{ page.doi | escape }}">
<meta name="dc.identifier" content="doi:{{ page.doi | escape }}">
{% endif %}

<link rel="canonical" href="{{ page.url | absolute_url }}">
<meta name="citation_public_url" content="{{ page.url | absolute_url }}">

{% if page.pdf %}
<meta name="citation_pdf_url" content="{{ page.pdf | absolute_url }}">
{% endif %}

{% if page.abstract %}
<meta name="citation_abstract" content="{{ page.abstract | strip_html | normalize_whitespace | escape }}">
{% endif %}

{% if page.language %}
<meta name="citation_language" content="{{ page.language | escape }}">
{% endif %}
